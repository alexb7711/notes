<!DOCTYPE html>
<html>
<head>
    <title>setuptools</title>
    <link href="style.css" rel="stylesheet">
</head>
<body>
<div id="navigation">
<ul>
<li><a class="%blog.html%" href="blog.html">blog</a></li>
<li><a class="%notes.html%" href="notes.html">notes</a></li>
<li><a class="%projects.html%" href="projects.html">projects</a></li>
<li><a class="%index.md%" href="index.html">index</a></li>
</ul>
</div>

<div class="content">
<h1 id="package-discovery-and-namespace-packages">Package Discovery and Namespace Packages</h1>
<p>In a typical <code>project.toml</code> file one would manualy specxfy the packages to be included:</p>
<pre class="codehilite"><code class="language-toml"># ...
[tool.setuptools]
packages = [&quot;mypkg&quot;, &quot;mypkg.subpkg1&quot;, &quot;mypkg.subpkg2&quot;]
# ...
</code></pre>

<p>If you have an unconventional package structure, you may also have to configure <code>package_dir</code>:</p>
<pre class="codehilite"><code class="language-toml">[tool.setuptools]
# ...
package-dir = {&quot;&quot; = &quot;src&quot;}
    # directory containing all the packages (e.g.  src/mypkg1, src/mypkg2)

# OR

[tool.setuptools.package-dir]
mypkg = &quot;lib&quot;
# mypkg.module corresponds to lib/module.py
&quot;mypkg.subpkg1&quot; = &quot;lib1&quot;
# mypkg.subpkg1.module1 corresponds to lib1/module1.py
&quot;mypkg.subpkg2&quot; = &quot;lib2&quot;
# mypkg.subpkg2.module2 corresponds to lib2/module2.py
# ...
</code></pre>

<h2 id="automatic-discovery">Automatic Discovery</h2>
<p>Seutptools considers two popular project layouts (src-layout and flat-layout). Setuptools by default will scan your project and look for these directory layouts and try to guess the values for the <code>packages</code> and <code>py_modules</code>. Note that automatic discovery will only occur if <code>packages</code> and <code>py_modules</code> are not provided in the configuration.</p>
<h3 id="src-layout">src-layout</h3>
<p>The src-layout is useful for automatic discovery since you don't have to worry about other python files or folders in your project root being distributed by mistake.</p>
<pre class="codehilite"><code>project_root_directory
├── pyproject.toml  # AND/OR setup.cfg, setup.py
├── ...
└── src/
    └── mypkg/
        ├── __init__.py
        ├── ...
        ├── module.py
        ├── subpkg1/
        │   ├── __init__.py
        │   ├── ...
        │   └── module1.py
        └── subpkg2/
            ├── __init__.py
            ├── ...
            └── module2.py
</code></pre>

<h3 id="flat-layout">flat-layout</h3>
<p>This method is practical for using the REPL, but can be more error prone. To avoid confusion, file and folder names that are used by popular tools (or well-known conventions) are automatically filtered out.</p>
<pre class="codehilite"><code>project_root_directory
├── pyproject.toml  # AND/OR setup.cfg, setup.py
├── ...
└── mypkg/
    ├── __init__.py
    ├── ...
    ├── module.py
    ├── subpkg1/
    │   ├── __init__.py
    │   ├── ...
    │   └── module1.py
    └── subpkg2/
        ├── __init__.py
        ├── ...
        └── module2.py
</code></pre>

<p>Default excluded names:</p>
<pre class="codehilite"><code class="language-python">FlatLayoutPackageFinder.DEFAULT_EXCLUDE: ClassVar[tuple[str, ...]] = ('ci', 'ci.*', 'bin', 'bin.*', 'debian', 'debian.*', 'doc', 'doc.*', 'docs', 'docs.*', 'documentation', 'documentation.*', 'manpages', 'manpages.*', 'news', 'news.*', 'newsfragments', 'newsfragments.*', 'changelog', 'changelog.*', 'test', 'test.*', 'tests', 'tests.*', 'unit_test', 'unit_test.*', 'unit_tests', 'unit_tests.*', 'example', 'example.*', 'examples', 'examples.*', 'scripts', 'scripts.*', 'tools', 'tools.*', 'util', 'util.*', 'utils', 'utils.*', 'python', 'python.*', 'build', 'build.*', 'dist', 'dist.*', 'venv', 'venv.*', 'env', 'env.*', 'requirements', 'requirements.*', 'tasks', 'tasks.*', 'fabfile', 'fabfile.*', 'site_scons', 'site_scons.*', 'benchmark', 'benchmark.*', 'benchmarks', 'benchmarks.*', 'exercise', 'exercise.*', 'exercises', 'exercises.*', 'htmlcov', 'htmlcov.*', '[._]*', '[._]*.*')
</code></pre>

<p>Reserved package names:</p>
<pre class="codehilite"><code class="language-python">FlatLayoutModuleFinder.DEFAULT_EXCLUDE: ClassVar[tuple[str, ...]] = ('setup', 'conftest', 'test', 'tests', 'example', 'examples', 'build', 'toxfile', 'noxfile', 'pavement', 'dodo', 'tasks', 'fabfile', '[Ss][Cc]onstruct', 'conanfile', 'manage', 'benchmark', 'benchmarks', 'exercise', 'exercises', '[._]*')
</code></pre>

<h3 id="single-module-distribution">single-module distribution</h3>
<p>There is a unique configuration of the flat-layout called the single-module distribution method. This method is useful when you have a stand alone module that consists of just one file:</p>
<pre class="codehilite"><code>project_root_directory
├── pyproject.toml  # AND/OR setup.cfg, setup.py
├── ...
└── single_file_lib.py
</code></pre>

<h2 id="custom-discovery">Custom Discovery</h2>
<p>If  automatic the search is not working or you wish to use packages that use reserved names such as <code>task</code>, <code>example</code>, or <code>docs</code>, or you want to exclude nested packages, you can use the following tools for package discovery:</p>
<pre class="codehilite"><code class="language-toml"># ...
[tool.setuptools.packages]
find = {}  # Scanning implicit namespaces is active by default
# OR
find = {namespaces = false}  # Disable implicit namespaces
</code></pre>

<h3 id="finding-simple-packages">Finding Simple Packages</h3>
<p>Consider the following project tree</p>
<pre class="codehilite"><code>mypkg
├── pyproject.toml  # AND/OR setup.cfg, setup.py
└── src
    ├── pkg1
    │   └── __init__.py
    ├── pkg2
    │   └── __init__.py
    ├── additional
    │   └── __init__.py
    └── pkg
        └── namespace
            └── __init__.py
</code></pre>

<p>To have setuptools automatically include packages found in the <code>src</code> directory that start with the name <code>pkg</code> and not <code>additional</code>:</p>
<pre class="codehilite"><code class="language-toml">[tool.setuptools.packages.find]
where = [&quot;src&quot;]
include = [&quot;pkg*&quot;]  # alternatively: `exclude = [&quot;additional*&quot;]`
namespaces = false
</code></pre>

<h1 id="resources">Resources</h1>
<p>- <a href="https://setuptools.pypa.io/en/latest/userguide/package_discovery.html#finding-simple-packages">https://setuptools.pypa.io/en/latest/userguide/package_discovery.html#finding-simple-packages</a></p>
</div>
<footer>
<p>Generated by Pymind: 2025-07-26</p>
</footer>

</body>
</html>
